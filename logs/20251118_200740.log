2025-11-18 20:07:40 - trend_analyzer - INFO - Logging initialized - file: logs/20251118_200740.log
2025-11-18 20:07:40 - trend_analyzer - INFO - Loading trend_analyzer package.
2025-11-18 20:07:40 - trend_analyzer - INFO - Loading config module...
2025-11-18 20:07:40 - trend_analyzer - INFO - Creating global config instance...
2025-11-18 20:07:40 - trend_analyzer - INFO - Initializing Config class
2025-11-18 20:07:40 - trend_analyzer - INFO - Successfully loaded all configuration files
2025-11-18 20:07:40 - trend_analyzer - INFO - === INFRASTRUCTURE CONFIGURATION ===
2025-11-18 20:07:40 - trend_analyzer - INFO - database:
2025-11-18 20:07:40 - trend_analyzer - INFO -   type: postgresql
2025-11-18 20:07:40 - trend_analyzer - INFO -   host: localhost
2025-11-18 20:07:40 - trend_analyzer - INFO -   port: 5432
2025-11-18 20:07:40 - trend_analyzer - INFO -   database: aca_health
2025-11-18 20:07:40 - trend_analyzer - INFO -   username: etl
2025-11-18 20:07:40 - trend_analyzer - INFO -   password: etl
2025-11-18 20:07:40 - trend_analyzer - INFO -   schema: dw
2025-11-18 20:07:40 - trend_analyzer - INFO -   statement_timeout_seconds: 30
2025-11-18 20:07:40 - trend_analyzer - INFO - output:
2025-11-18 20:07:40 - trend_analyzer - INFO -   dir: ./output
2025-11-18 20:07:40 - trend_analyzer - INFO -   format: json
2025-11-18 20:07:40 - trend_analyzer - INFO -   filename: trend_analysis_report
2025-11-18 20:07:40 - trend_analyzer - INFO -   include_charts: True
2025-11-18 20:07:40 - trend_analyzer - INFO - test_data:
2025-11-18 20:07:40 - trend_analyzer - INFO -   connection_tests: ['postgresql']
2025-11-18 20:07:40 - trend_analyzer - INFO -   run_sample_queries: True
2025-11-18 20:07:40 - trend_analyzer - INFO - ai:
2025-11-18 20:07:40 - trend_analyzer - INFO -   model: gpt-4
2025-11-18 20:07:40 - trend_analyzer - INFO -   temperature: 0.3
2025-11-18 20:07:40 - trend_analyzer - INFO - === END INFRASTRUCTURE CONFIGURATION ===
2025-11-18 20:07:40 - trend_analyzer - INFO - === ANALYSIS CONFIGURATION ===
2025-11-18 20:07:40 - trend_analyzer - INFO - test_data: False
2025-11-18 20:07:40 - trend_analyzer - INFO - build_cubes: False
2025-11-18 20:07:40 - trend_analyzer - INFO - cube_building:
2025-11-18 20:07:40 - trend_analyzer - INFO -   force_rebuild: False
2025-11-18 20:07:40 - trend_analyzer - INFO -   validate_data: True
2025-11-18 20:07:40 - trend_analyzer - INFO - run_analysis: True
2025-11-18 20:07:40 - trend_analyzer - INFO - analyze:
2025-11-18 20:07:40 - trend_analyzer - INFO -   group_by_dimensions: ['state', 'year']
2025-11-18 20:07:40 - trend_analyzer - INFO -   filters: [{'dimension_name': 'state', 'operator': 'IN', 'value': ['CA', 'NY', 'TX']}, {'dimension_name': 'year', 'operator': '>=', 'value': 2023}]
2025-11-18 20:07:40 - trend_analyzer - INFO -   top_n: 100
2025-11-18 20:07:40 - trend_analyzer - INFO -   include_totals: True
2025-11-18 20:07:40 - trend_analyzer - INFO - trends:
2025-11-18 20:07:40 - trend_analyzer - INFO -   time_periods: ['monthly', 'quarterly', 'yearly']
2025-11-18 20:07:40 - trend_analyzer - INFO -   comparison_type: year_over_year
2025-11-18 20:07:40 - trend_analyzer - INFO -   minimum_data_points: 3
2025-11-18 20:07:40 - trend_analyzer - INFO -   confidence_threshold: 0.95
2025-11-18 20:07:40 - trend_analyzer - INFO - metrics:
2025-11-18 20:07:40 - trend_analyzer - INFO -   primary: ['allowed', 'member_months']
2025-11-18 20:07:40 - trend_analyzer - INFO -   secondary: ['per_member_per_month', 'utilization_rate']
2025-11-18 20:07:40 - trend_analyzer - INFO - alerts:
2025-11-18 20:07:40 - trend_analyzer - INFO -   significant_change_pct: 15.0
2025-11-18 20:07:40 - trend_analyzer - INFO -   outlier_threshold: 2.0
2025-11-18 20:07:40 - trend_analyzer - INFO -   minimum_sample_size: 100
2025-11-18 20:07:40 - trend_analyzer - INFO - === END ANALYSIS CONFIGURATION ===
2025-11-18 20:07:40 - trend_analyzer - INFO - Enabled operations: analysis
2025-11-18 20:07:40 - trend_analyzer - INFO - === DIMENSIONS CONFIGURATION ===
2025-11-18 20:07:40 - trend_analyzer - INFO - _meta:
2025-11-18 20:07:40 - trend_analyzer - INFO -   descriptor_alias: clc
2025-11-18 20:07:40 - trend_analyzer - INFO -   norm_alias: m
2025-11-18 20:07:40 - trend_analyzer - INFO - _targets:
2025-11-18 20:07:40 - trend_analyzer - INFO -   dataset: skeleton_test
2025-11-18 20:07:40 - trend_analyzer - INFO -   descriptor_table: trend_descriptor_test
2025-11-18 20:07:40 - trend_analyzer - INFO -   norm_table: trend_norm_test
2025-11-18 20:07:40 - trend_analyzer - INFO - _years:
2025-11-18 20:07:40 - trend_analyzer - INFO -   2023: {'member_snapshot': 'placeholder.member_table_2023', 'claim_snapshot': 'placeholder.claim_table_2023', 'months': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]}
2025-11-18 20:07:40 - trend_analyzer - INFO -   2024: {'member_snapshot': 'placeholder.member_table_2024', 'claim_snapshot': 'placeholder.claim_table_2024', 'months': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]}
2025-11-18 20:07:40 - trend_analyzer - INFO - _norm_joins:
2025-11-18 20:07:40 - trend_analyzer - INFO - _descriptor_joins:
2025-11-18 20:07:40 - trend_analyzer - INFO - _filters:
2025-11-18 20:07:40 - trend_analyzer - INFO -   common: ["placeholder_filter = 'skeleton'"]
2025-11-18 20:07:40 - trend_analyzer - INFO -   norm: ['test_account = false']
2025-11-18 20:07:40 - trend_analyzer - INFO -   descriptor: ['is_test_claim = false']
2025-11-18 20:07:40 - trend_analyzer - INFO - dimensions: [{'name': 'state', 'scope': 'both', 'expr': 'state', 'description': 'US state where the plan is offered'}, {'name': 'year', 'scope': 'both', 'expr': 'EXTRACT(YEAR FROM {norm_alias}.month)', 'description': 'Calendar year of the enrollment/claim'}]
2025-11-18 20:07:40 - trend_analyzer - INFO - metrics: [{'name': 'allowed', 'scope': 'descriptor', 'requires': ['allowed'], 'expr': 'SUM(allowed)'}, {'name': 'member_months', 'scope': 'norm', 'requires': ['ra_mm'], 'expr': 'SUM(ra_mm)'}]
2025-11-18 20:07:40 - trend_analyzer - INFO - === END DIMENSIONS CONFIGURATION ===
2025-11-18 20:07:40 - trend_analyzer - INFO - ===START TREND ANALYZER===
2025-11-18 20:07:40 - trend_analyzer - INFO - TREND ANALYZER===arting up...
2025-11-18 20:07:40 - trend_analyzer - INFO - Loading configuration from config directory...
2025-11-18 20:07:40 - trend_analyzer - INFO - Configuration loaded successfully from:
2025-11-18 20:07:40 - trend_analyzer - INFO -   - config/infrastructure.yml
2025-11-18 20:07:40 - trend_analyzer - INFO -   - config/analysis.yml
2025-11-18 20:07:40 - trend_analyzer - INFO -   - config/dimensions.yml
2025-11-18 20:07:40 - trend_analyzer - INFO - Will run: analysis
2025-11-18 20:07:40 - trend_analyzer - INFO - EXECUTING: Trend Analysis (PostgreSQL)
2025-11-18 20:07:40 - trend_analyzer - INFO - Database: postgresql at localhost
2025-11-18 20:07:40 - trend_analyzer - INFO - Group by: ['state', 'year']
2025-11-18 20:07:40 - trend_analyzer - INFO - Filters: 2 filters
2025-11-18 20:07:40 - trend_analyzer - INFO - Top N: 100
2025-11-18 20:07:40 - trend_analyzer - INFO - Output format: json
2025-11-18 20:07:40 - trend_analyzer - INFO - Loading auth module...
2025-11-18 20:07:41 - trend_analyzer - INFO - Getting PostgreSQL client...
2025-11-18 20:07:41 - trend_analyzer - INFO - 
SQL Query Executed:
2025-11-18 20:07:41 - trend_analyzer - INFO - Query returned 100 rows
2025-11-18 20:07:41 - trend_analyzer - INFO - Would execute AI analysis...
2025-11-18 20:07:41 - trend_analyzer - INFO - Analysis complete
2025-11-18 20:07:41 - trend_analyzer - INFO - Execution completed successfully
